{"version":3,"file":"graphboard.min.js","sources":["../../src/canvas/setupHiDefCanvas.js","../../src/graph/Graph.js","../../src/Vector.js","../../src/graph/Node.js","../../src/graph/Link.js","../../src/layout/ForceDirected.js","../../src/shape/Constants.js","../../src/shape/Shape.js","../../src/shape/Arc.js","../../src/shape/Circle.js","../../src/shape/Rectangle.js","../../src/InputDeviceTracker.js","../../src/canvas/Renderer.js","../../src/MChart.js","../../src/index.js"],"sourcesContent":["/**\n * Create a High Definition Canvas.\n *\n * @param {*} canvas\n * @returns Scaled 2d Context\n */\nexport default function setupHiDefCanvas(canvas) {\n\t// Get the device pixel ratio, falling back to 1.\n\tvar devicePixelRatio = window.devicePixelRatio || 1;\n\n\tvar ctx = canvas.getContext(\"2d\");\n\tconst backingStoreRatio = ctx.backingStorePixelRatio  || 1;\n\n\tconst ratio = devicePixelRatio / backingStoreRatio;\n\n\tconsole.log(\"ratio = \" + ratio)\n\n\n\t// Get the size of the canvas in CSS pixels.\n\t//var rect = canvas.getBoundingClientRect();\n\n    const initialWidth = canvas.width;\n    const initialHeight = canvas.height;\n\n\n\t// On Hi Def like Retina display we double the size of the canvas\n\tcanvas.width = initialWidth * ratio;\n\tcanvas.height = initialHeight * ratio;\n    ctx.scale(ratio, ratio);\n\n\t// and we shrink the display size using CSS\n\tcanvas.style.width = initialWidth + 'px';\n    canvas.style.height = initialHeight + 'px';\n\treturn ctx;\n}\n\n","\n// =============================================================\n//                          Graph\n// =============================================================\nexport default class Graph {\n    constructor() {\n\n        this.graph = {};\n        this.nodeList = [];\n        this.linkList = [];\n        this.adjacency = {};\n        this.changed = false;\n        this.root;\n    }\n\n    test () {\n        console.log(\"test\")\n    }\n}","/**\n *  A vector is an entity that has both magnitude and direction.\n *  2D vector implementation based on the vector functions in P5.js\n */\nexport class Vector {\n\tconstructor(x, y) {\n\t\tthis.x = x || 0;\n\t\tthis.y = y || 0;\n\n\t\tif (isNaN(x) || isNaN(y)) {\n\t\t\tconsole.warn(`Vector(): parameters are not number: (${x}), ${y} `);\n\t\t}\n\t\t/*\n\t\tconsole.log(\"in Vector()\");\n\t\tconsole.log(\"this.x  = \" + this.x);\n\t\tconsole.log(\"this.y  = \" + this.y);\n\n\t\tconsole.log(\"typeof x  = \" + typeof y);\n\t\tconsole.log(\"typeof y  = \" + typeof y);\n\t\t*/\n\t}\n\n\tstatic add(v1, v2) {\n\t\treturn new Vector(v1.x + v2.x, v1.y + v2.y);\n\t}\n\n\t/**\n\t * Divides a vector by a scalar and returns a new vector.\n\t *\n\t * @method div\n\t * @static\n\t * @param  {Vector} v\n\t * @param  {Number}  n\n\t * @return  {Vector}\n\t */\n\tstatic div(v, n) {\n\t\tlet result = v.copy();\n\t\treturn result.div(n);\n\t}\n\n\t/**\n\t * Linear interpolate the vector to another vector\n\t */\n\tstatic lerp(v1, v2, amount) {\n\t\tlet result = v1.copy();\n\t\treturn result.lerp(v2, amount);\n\t}\n\n\tstatic random(min, max) {\n\t\tlet x = randomIntBounds(min, max);\n\t\tlet y = randomIntBounds(min, max);\n\t\treturn new Vector(x, y);\n\t}\n\n\tstatic sub(v1, v2) {\n\t\treturn new Vector(v1.x - v2.x, v1.y - v2.y);\n\t}\n\n\t/**\n\t * Supports adding a Vector or a Scalar\n\t * @param {*} n\n\t * @returns\n\t */\n\tadd(n) {\n\t\tif (n instanceof Vector) {\n\t\t\tthis.x += n.x;\n\t\t\tthis.y += n.y;\n\t\t\treturn this;\n\t\t} else if (typeof n === \"number\") {\n\t\t\tthis.x += n;\n\t\t\tthis.y += n;\n\t\t\treturn this;\n\t\t} else {\n\t\t\tconsole.error(`Parameter in Vector.add(n) Not supported: ${n})`);\n\t\t}\n\t}\n\n\t/**\n\t *  Return a new vector\n\t * @returns\n\t */\n\tcopy() {\n\t\treturn new Vector(this.x, this.y);\n\t}\n\n\t/* divide vector length (ie magnitude) by a constant*/\n\tdiv(n) {\n\t\tif (n === 0) {\n\t\t\t//console.warn(\"Vector.div:\", \"divide by 0\");\n\t\t\treturn this;\n\t\t}\n\t\tthis.x /= n;\n\t\tthis.y /= n;\n\t\treturn this;\n\t}\n\n\tlerp(v1, amount) {\n\t\tthis.x += (v1.x - this.x) * amount || 0;\n\t\tthis.y += (v1.y - this.y) * amount || 0;\n\t\treturn this;\n\t}\n\n\theading() {\n\t\tconst h = Math.atan2(this.y, this.x);\n\t\treturn h;\n\t}\n\n\tmagSq() {\n\t\tconst x = this.x;\n\t\tconst y = this.y;\n\t\treturn x * x + y * y;\n\t}\n\n\tmag() {\n\t\treturn Math.sqrt(this.magSq());\n\t}\n\n\tnormalize() {\n\t\treturn this.div(this.mag());\n\t}\n\n\t/**\n\tMultiply vector length (ie magnitude) by a constant\n\t*/\n\tmult(n) {\n\t\tthis.x *= n;\n\t\tthis.y *= n;\n\t\treturn this;\n\t}\n\n\t/**\n\t *  set magnitude to a given value\n\t */\n\tsetMag(n) {\n\t\treturn this.normalize().mult(n);\n\t}\n\n\n\t/**\n\t * \n\t * @param {*} n \n\t * @returns \n\t */\n\tsub(n) {\n\t\tif (n instanceof Vector) {\n\t\t\tthis.x -= n.x;\n\t\t\tthis.y -= n.y;\n\t\t\treturn this;\n\t\t} else if (typeof n === \"number\") {\n\t\t\tthis.x -= n;\n\t\t\tthis.y -= n;\n\t\t\treturn this;\n\t\t} else {\n\t\t\tconsole.error(`Parameter in Vector.sub(n) Not supported: ${n})`);\n\t\t}\n\t}\n\n\ttoString() {\n\t\treturn \"[\" + this.x + \", \" + this.y + \"]\";\n\t}\n}\n\n/* Return a random integer between min and max (inclusive) */\nfunction randomIntBounds(min, max) {\n\treturn Math.floor(Math.random() * (max - min + 1) + min);\n}\n\nexport default Vector;\n","\nimport Vector from '../Vector';\n\n  const PI_2 = Math.PI * 2;\n\nexport default class Node {\n\n\n    constructor(id) {\n      this.id = id;\n      this.size = 20;\n      this.mass = (PI_2 * this.size) / 1.5;\n      this.radius = this.size;\n\n      this.pos = new Vector(0, 0);\n      this.force = new Vector(0, 0);\n      this.velocity = new Vector(0, 0);\n      this.acceleration = new Vector(0, 0);\n    }\n    draw(ctx) {\n      ctx.beginPath();\n//      ctx.fillStyle = \"darkGrey\";\n      ctx.fillStyle = \"rgb(176,225,206)\";\n\n      ctx.arc(this.pos.x, this.pos.y, this.radius, 0, PI_2, false);\n      ctx.fill();\n      ctx.closePath();\n      ctx.fillStyle = \"black\";\n      ctx.textAlign = \"center\";\n      ctx.textBaseline = \"middle\";\n      ctx.fillText(this.id, this.pos.x, this.pos.y);\n    }\n\n    /**\n     *  applyForce\n     *\n     *  Newton’s second law.\n     *  Receive a force, divide by mass, and add to acceleration.\n    */\n    __applyForce(force) {\n      let f = Vector.div(force, this.mass);\n      this.acceleration.add(f);\n    }\n\n\n    toString() {\n      return \"[\" + this.id + \", \" + this.pos.x + \", \" + this.pos.y + \"]\";\n    }\n  }","export default class Link {\n\tconstructor(source, target) {\n\t\tif (source.id & target.id) {\n\t\t\tthis.id = source.id + \"-\" + target.id;\n\t\t}\n\t\telse {\n\t\t\tthis.id = source + \"-\" + target;\n\t\t}\n\t\tthis.source = source;\n\t\tthis.target = target;\n\t}\n}\n","import Vector from \"../Vector\";\n\nexport default class ForceDirected {\n\tconstructor(graph, options) {\n\t\tthis.graph = graph;\n\t\tthis.initNodes();\n\n\t\tconst DEFAULTS = {\n\t\t\tGRAVITY: 2, // 0.9,\n\t\t\tREPULSION: 500000,\n\t\t};\n\t\tthis.options = Object.assign({}, DEFAULTS, options);\n\t}\n\n\tinitNodes() {\n\t\tlet min = -1000;\n\t\tlet max = 1000;\n\n\t\tthis.graph.nodeList.forEach((node) => {\n\t\t\tnode.pos = new Vector.random(min, max);\n\t\t});\n\t}\n\n\tapplyForcesTowardsCenter() {\n\t\t// apply force towards center\n\t\tthis.graph.nodeList.forEach((node) => {\n\t\t\tlet gravity = node.pos.copy().mult(-1).mult(this.options.GRAVITY);\n\t\t\tnode.force = gravity;\n\t\t\t//node.applyForce(gravity);\n\t\t\t//console.log(node);\n\t\t});\n\t}\n\n\tapplyRepulsiveForces() {\n\t\t// apply repulsive force between nodes\n\t\tfor (let i = 0; i < this.graph.nodeList.length; i++) {\n\t\t\tfor (let j = i + 1; j < this.graph.nodeList.length; j++) {\n\t\t\t\tif (i != j) {\n\t\t\t\t\tlet node1 = this.graph.nodeList[i];\n\t\t\t\t\tlet node2 = this.graph.nodeList[j];\n\n\t\t\t\t\t// The gravitational force F between two bodies of mass m1 and m2 is\n\t\t\t\t\t// F = G*m1*m2 / r2\n\t\t\t\t\t// the vector that points from one object to the other\n\t\t\t\t\tlet dir = Vector.sub(node2.pos, node1.pos);\n\t\t\t\t\t// let unit = dir.copy().normalize()\n\n\t\t\t\t\t// the length (magnitude) of that vector is the distance between the two objects.\n\t\t\t\t\tlet distance = dir.mag();\n\n\t\t\t\t\t// The strength of the force is inversely proportional to the distance squared.\n\t\t\t\t\t// The farther away an object is, the weaker the force; the closer, the stronger.\n\n\t\t\t\t\t// original  : without the normalize\n\t\t\t\t\tdir.normalize();\n\n\t\t\t\t\tlet force1 = dir.mult(this.options.REPULSION);\n\t\t\t\t\tforce1.div(distance * distance);\n\n\t\t\t\t\tlet inverseForce = force1.copy().mult(-1);\n\t\t\t\t\tnode2.force.add(force1);\n\t\t\t\t\tnode1.force.add(inverseForce);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tapplyForcesExertedByConnections() {\n\t\tthis.graph.linkList.forEach((link) => {\n\t\t\tlet node1 = this.graph.nodeList[link.source];\n\t\t\tlet node2 = this.graph.nodeList[link.target];\n\n\t\t\t//let maxDis = con[2];\n\n\t\t\tlet dir = Vector.sub(node1.pos, node2.pos);\n\n\t\t\tlet neg_force = new Vector(0, 0).sub(dir);\n\t\t\tlet pos_force = new Vector(0, 0).add(dir);\n\n\t\t\tnode1.force.add(neg_force);\n\t\t\tnode2.force.add(pos_force);\n\t\t});\n\t}\n\n\tupdateNodesVelocity() {\n\t\tthis.graph.nodeList.forEach((node) => {\n\t\t\tlet force_copy = node.force.copy();\n\t\t\tlet velocity = force_copy.div(node.mass);\n\t\t\tnode.pos.add(velocity);\n\t\t\t/*\n\t\t\t\t  this.velocity.add(this.acceleration);\n\t\t\t\t  this.pos.add(this.velocity);\n\t\t\t\t  this.acceleration.mult(0);\n\t\t\t\t  */\n\t\t});\n\t}\n\n\tapplyForces() {\n\t\t// Force equals mass times acceleration.\n\t\t// Newton’s second law, F→=M×A→ (or force = mass * acceleration).\n\t\tthis.applyForcesTowardsCenter();\n\n\t\tthis.applyRepulsiveForces();\n\n\t\tthis.applyForcesExertedByConnections();\n\n\t\tthis.updateNodesVelocity();\n\t\t// kinetic energy (KE) is equal to half of an object's mass (1/2*m) multiplied by the velocity squared.\n\t\t//let total_KE = 0.0;\n\t\t/*\n    nodes.forEach((node) => {\n      let node_KE = (0.5 * node.mass * node.velocity * node.velocity);\n      total_KE =+  node_KE;\n      });\n      console.log(\"total_KE=\" + total_KE);\n  */\n\t}\n}\n","\n\nexport var NONE = \"none\";\nexport var pi = Math.PI;\n","import {NONE} from './Constants.js';\n\nexport default class Shape {\n    constructor(x, y, type) {\n        this.type = type;\n        this.x = x;\n        this.y = y;\n        this.isSelected = false;\n        this.strokeStyle = NONE;\n\n    }\n    getColor() {\n        return this.color;\n    }\n}","import Shape from './Shape.js';\nimport { NONE } from './Constants.js';\n\nexport default class Arc extends Shape {\n  constructor(x, y, radius, radians) {\n    super(x, y);\n    this.radius = radius;\n    this.radians = radians;\n  }\n  isHit(x, y) {\n    var dx = this.x - x;\n    var dy = this.y - y;\n    if (dx * dx + dy * dy < this.radius * this.radius) {\n      return true;\n    }\n  }\n  render(ctx) {\n    ctx.save();\n\n    ctx.beginPath();\n    ctx.arc(this.x, this.y, this.radius, 0, this.radians, false);\n\n    if (this.fillStyle) {\n      ctx.fillStyle = this.fillStyle;\n      ctx.fill();\n    }\n\n    if (this.strokeStyle != NONE) {\n      ctx.strokeStyle = this.strokeStyle;\n      ctx.lineWidth = this.lineWidth;\n      ctx.stroke();\n    }\n\n    ctx.restore();\n  }\n}","import Arc from './Arc.js';\n\n\nexport default class Circle extends Arc {\n    constructor(x, y, radius) {\n      super(x, y, radius, Math.PI *2);\n    }\n    isHit(x, y) {\n      var dx = this.x - x;\n      var dy = this.y - y;\n      if (dx * dx + dy * dy < this.radius * this.radius) {\n        return true;\n      }\n    }\n\n    getBBox() {\n      return {\n        x: this.x - this.radius,\n        y: this.y - this.radius,\n        width : this.radius * 2,\n        height : this.radius * 2\n      }\n    }\n  }","import Shape from './Shape.js';\nimport { NONE } from './Constants.js';\n\n\nexport default class Rectangle extends Shape {\n    constructor(x, y, width, height) {\n        super(x, y);\n        this.width = width;\n        this.height = height;\n    }\n    getArea() {\n        return this.width * this.height;\n    }\n\n    isHit(x, y) {\n        if (\n            x > this.x &&\n            x < this.x + this.width &&\n            y > this.y &&\n            y < this.y + this.height\n        ) {\n            return true;\n        }\n    }\n    render(ctx) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.rect(\n            this.x,\n            this.y,\n            this.width,\n            this.height\n        );\n\n        if (this.fillStyle) {\n            ctx.fillStyle = this.fillStyle;\n            ctx.fill();\n        }\n        if (this.strokeStyle != NONE) {\n            ctx.strokeStyle = this.strokeStyle;\n            ctx.lineWidth = this.lineWidth;\n            ctx.stroke();\n        }\n        ctx.restore();\n    }\n    toString() {\n        return `rectangle:  (${this.x},${this.y}) x (${this.width},${this.height})`;\n    }\n}","export default class InputDeviceTracker {\n\n    constructor(canvas, callback) {\n        console.log(\"InputDeviceTracker ()\");\n\n        this.canvas = canvas;\n        this.callback = callback;\n        self = this;\n\n        console.log(\"constructor this\");\n        console.log(this);\n\n        this.canvas.addEventListener('mousedown', this.onDown.bind(this));\n        this.canvas.addEventListener('mousemove', this.onMove.bind(this));\n        this.canvas.addEventListener('mouseup', this.onUp.bind(this));\n\n        this.canvas.addEventListener('touchstart', this.onDown.bind(this));\n        this.canvas.addEventListener('touchmove', this.onMove.bind(this));\n        this.canvas.addEventListener('touchend', this.onUp.bind(this));\n    }\n\n    getCoordinatesFromEvent(evt) {\n        var rect = self.canvas.getBoundingClientRect();\n        var offsetTop = rect.top;\n        var offsetLeft = rect.left;\n\n        if (evt.touches) {\n            return {\n                x: evt.touches[0].clientX - offsetLeft,\n                y: evt.touches[0].clientY - offsetTop\n            };\n        } else {\n            return {\n                x: evt.clientX - offsetLeft,\n                y: evt.clientY - offsetTop\n            };\n        }\n    }\n\n    onDown(evt) {\n        evt.preventDefault();\n        var coords = self.getCoordinatesFromEvent(evt);\n        self.callback(\"down\", coords.x, coords.y);\n    }\n\n    onUp(evt) {\n        evt.preventDefault();\n        self.callback(\"up\");\n    }\n\n    onMove(evt) {\n        evt.preventDefault();\n        var coords = self.getCoordinatesFromEvent(evt);\n        self.callback(\"move\", coords.x, coords.y);\n    }\n}","\n\nexport class Renderer {\n\n    constructor(ctx) {\n        this.ctx = ctx;\n    }\n\n    drawGrid(w, h) {\n\n        this.ctx.save()\n\n        this.ctx.fillStyle = 'white'\n        this.ctx.fillRect(0, 0, w, h)\n        this.ctx.lineWidth = 0.3;\n        this.ctx.strokeStyle = 'lightgray'\n        this.ctx.fillStyle = 'black'\n\n        for (let i = 1; i < w; i++) {\n            this.ctx.beginPath()\n            if (i % 10 === 0) {\n                this.ctx.moveTo(i, 0);\n                this.ctx.lineTo(i, h)\n                this.ctx.moveTo(i, 0);\n            }\n            this.ctx.closePath()\n            this.ctx.stroke()\n        }\n\n        for (let i = 1; i < h; i++) {\n            this.ctx.beginPath()\n            if (i % 10 === 0) {\n                this.ctx.moveTo(0, i)\n                this.ctx.lineTo(w, i)\n                this.ctx.moveTo(0, i)\n            }\n            this.ctx.closePath()\n            this.ctx.stroke()\n        }\n\n\n        this.ctx.lineWidth = 1\n        this.ctx.strokeStyle = 'gray'\n\n        this.ctx.beginPath()\n        for (let i = 50; i < w; i += 10) {\n            if (i % 50 === 0) {\n                this.ctx.moveTo(i, 0)\n                this.ctx.lineTo(i, 30)\n                this.ctx.fillText(` ${i}`, i, 30)\n            } else {\n                this.ctx.moveTo(i, 0)\n                this.ctx.lineTo(i, 10)\n            }\n\n        }\n        this.ctx.closePath()\n        this.ctx.stroke()\n\n        this.ctx.beginPath()\n        for (let i = 50; i < h; i += 10) {\n            if (i % 50 === 0) {\n                this.ctx.moveTo(0, i)\n                this.ctx.lineTo(30, i)\n                this.ctx.fillText(` ${i}`, 30, i)\n            } else {\n                this.ctx.moveTo(0, i)\n                this.ctx.lineTo(10, i)\n            }\n\n        }\n        this.ctx.closePath()\n        this.ctx.stroke()\n\n        this.ctx.restore()\n    }\n}","import InputDeviceTracker from './InputDeviceTracker'\nimport { Rectangle, Circle } from './shape';\nimport { Renderer } from './canvas/Renderer';\n\nexport class MChart {\n\n  constructor(container, options) {\n    console.log(\"MChart container()\");\n    console.log(container);\n    this.container = container;\n    this.startX = 0, this.startY = 0;\n    this.lastMoveX = 0, this.lastMoveY = 0;\n\n    this.canvas = document.getElementById(\"canvas\");\n    this.ctx = this.canvas.getContext(\"2d\");\n\n    //let w = canvas.width = canvas2.width = window.innerWidth * 0.9;\n    //let h = canvas.height = canvas2.height = window.innerHeight * 0.9;\n\n    this.w = this.canvas.width = window.innerWidth ;\n    this.h = this.canvas.height = window.innerHeight ;\n\n    this.renderer = new Renderer(this.ctx);\n\n    const DEFAULTS = {\n      display_grid: false,\n      selection: {\n        strokeStyle: '#CC0000', //  'rgba(255,51,0,1)', //'rgba(0,128,255,1)';\n        lineWidth: 0.5,\n        fillStyle: 'rgba(255,51,0,0.05)'  //'rgba(0,128,255, 0.2)';\n      }\n    }\n    this.options = Object.assign({}, DEFAULTS, options);\n\n    /* The selection rectangle */\n    this.selection = new Rectangle(100, 100, 100, 100);\n    this.selection.strokeStyle = this.options.selection.strokeStyle;\n    this.selection.fillStyle = this.options.selection.fillStyle;\n    this.selection.lineWidth = this.options.selection.lineWidth;\n\n    /* The list of ojbects to draw */\n    this.objects = [];\n\n    this.isSelecting = false;\n    this.isDragging = false;\n    this.clicked_on_the_canvas = false;\n  }\n\n  dump() {\n    console.log(\"MChart container= \");\n    console.log(\"- objects= \");\n    console.log(this.objects);\n  }\n\n  addObject(object) {\n    this.objects.push(object);\n    this.draw();\n  }\n\n  draw() {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n    if (this.options.display_grid) {\n      this.renderer.drawGrid(this.w, this.h);\n    }\n\n    this.objects.forEach((object) => {\n      object.render(this.ctx);\n      if (object.isSelected) {\n        var selection;\n        if (object instanceof Circle) {\n          var bbox = object.getBBox();\n          selection = new Rectangle(bbox.x, bbox.y, bbox.width, bbox.height);\n        }\n        else {\n          selection = new Rectangle(object.x, object.y, object.width, object.height);\n        }\n        selection.strokeStyle = this.options.selection.strokeStyle;\n        selection.lineWidth = this.options.selection.lineWidth;\n        selection.render(this.ctx);\n      }\n\n      if (this.isSelecting == true) {\n        this.selection.render(this.ctx);\n      }\n    })\n  }\n\n  manageInputEvents(evtType, x, y) {\n    switch (evtType) {\n      case \"down\":\n        this.mouseIsDown = true;\n\n        this.startX = x;\n        this.startY = y;\n        this.lastMoveX = x;\n        this.lastMoveY = y;\n\n        /* we assume the user clicked on the canvas unless we find an object was hit */\n        this.clicked_on_the_canvas = true;\n\n        // we start from last to check the shape that is on top first\n        for (var i = this.objects.length - 1; i >= 0; i--) {\n          var object = this.objects[i];\n          //    console.log (\"checking for hit object = \" + object.color);\n          if (object.isHit(x, y)) {\n            object.isSelected = true;\n            console.log(\"Clicked on : \" + object.constructor.name + \"/\" + object.fillStyle);\n            moveObjectToLastPosition(this.objects, object);\n            this.clicked_on_the_canvas = false;\n            this.isSelecting = false;\n            this.isDragging = true;\n          }\n\n        }\n        console.log(\"clicked on the canvas = \" + this.clicked_on_the_canvas);\n\n        if (this.clicked_on_the_canvas) {\n          console.log(\"clicked on the canvas\");\n          this.selection_startX = x;\n          this.selection_startY = y;\n\n          /* reset selection if user clicked on the canvas */\n          this.objects.forEach((object) => {\n            console.log(\"RESET object \" + object.fillStyle + \" is Circle ? \" + (object instanceof Circle));\n            object.isSelected = false;\n          });\n        }\n        break;\n\n      case \"up\":\n        this.mouseIsDown = false;\n        console.log(\"MOUSE UP\");\n        console.log(\" isDragging : \" + this.isDragging);\n        console.log(\" isSelecting : \" + this.isSelecting);\n\n        if (this.isSelecting) {\n\n\n\n          console.log(\" selection : \" + this.selection);\n          /* check if selection includes any object */\n          this.objects.forEach((object) => {\n\n            if (rectContainsShape(this.selection, object)) {\n              object.isSelected = true;\n              console.log(\"object is selected: \" + object.constructor.name + \"/\" + object.fillStyle);\n            }\n          });\n        }\n\n\n        this.isSelecting = false;\n        this.isDragging = false;\n        break;\n\n      case \"move\":\n        if (this.clicked_on_the_canvas && this.mouseIsDown) {\n          this.isSelecting = true;\n          // getting the min & max to handle when the user selects from bottom right to top left \n          const x1 = Math.min(this.selection_startX, this.lastMoveX);\n          const y1 = Math.min(this.selection_startY, this.lastMoveY);\n          const x2 = Math.max(this.selection_startX, this.lastMoveX);\n          const y2 = Math.max(this.selection_startY, this.lastMoveY);\n\n          this.selection.x = Math.floor(x1);\n          this.selection.y = Math.floor(y1);\n          this.selection.width = Math.floor(x2 - x1);\n          this.selection.height = Math.floor(y2 - y1);\n        }\n        this.lastMoveX = x;\n        this.lastMoveY = y;\n\n        var dx = x - this.startX;\n        var dy = y - this.startY;\n\n        this.startX = x;\n        this.startY = y;\n\n        if (this.isDragging) {\n          this.objects.forEach((object) => {\n            if (object.isSelected) {\n              object.x += dx;\n              object.y += dy;\n            }\n          });\n        }\n        break;\n    }\n    this.draw();\n  }\n\n  init() {\n    this.inputDeviceTracker = new InputDeviceTracker(this.canvas, this.manageInputEvents.bind(this));\n  }\n}\n\n/**\n *  We move the node selection to the last position so that it is drawn above the other shapes on the canvas\n */\nfunction moveObjectToLastPosition(object_list, object_to_move) {\n  object_list.forEach(function (object, index) {\n    if (object === object_to_move) {\n      object_list.splice(index, 1);\n      object_list.push(object_to_move);\n      return;\n    }\n  });\n}\n\n\n\nfunction rectContainsShape(rectangle, shape) {\n\n  if (shape.constructor.name == \"Circle\") {\n    return rectContainsCircle(rectangle, shape);\n  }\n  else if (shape.constructor.name == \"Rectangle\") {\n    return rectContainsRect(rectangle, shape);\n  }\n  else {\n    console.error(\"rectContainsShape: shape is unknown: \" + shape);\n  }\n}\n\nfunction rectContainsRect(rect1, rect2) {\n\n  var result_X = (rect1.x) < (rect2.x) &&\n    (rect1.x + rect1.width) > (rect2.x + rect2.width);\n\n  var result_Y = (rect1.y) < (rect2.y) &&\n    (rect1.y + rect1.height) > (rect2.y + rect2.height);\n\n  return result_X & result_Y;\n}\n\nfunction rectContainsCircle(rectangle, circle) {\n\n  // LEFT \n  var left_include = rectangle.x < circle.x - circle.radius;\n  if (!left_include) {\n    //circle is outside of the rectangle on the left side\n    return false;\n  }\n  // RIGHT \n  var right_include = rectangle.x + rectangle.width > circle.x + circle.radius;\n  if (!right_include) {\n    //circle is outside of the rectangle on the right side\n    return false;\n  }\n  // BOTTOM \n  var bottom_include = rectangle.y + rectangle.height > circle.y + circle.radius;\n  if (!bottom_include) {\n    //circle is outside of the rectangle on the bottom side\n    return false;\n  }\n  // TOP: \n  var top_include = rectangle.y < circle.y - circle.radius;\n  if (!top_include) {\n    //circle is outside of the rectangle on the top side\n    return false;\n  }\n  return true;\n}","\nexport * from \"./canvas\";\nexport * from \"./graph\";\nexport * from \"./layout\";\nexport * from \"./shape\";\n\nexport {MChart} from \"./MChart\";\nexport {Vector} from \"./Vector\";\n\nexport var version = \"0.1\"\n\n\n"],"names":["setupHiDefCanvas","canvas","devicePixelRatio","window","ctx","getContext","backingStoreRatio","backingStorePixelRatio","ratio","console","log","initialWidth","width","initialHeight","height","scale","style","Graph","graph","nodeList","linkList","adjacency","changed","root","Vector","x","y","isNaN","warn","n","error","v1","amount","h","Math","atan2","sqrt","magSq","div","mag","normalize","mult","v2","v","result","copy","lerp","min","max","randomIntBounds","floor","random","PI_2","PI","Node","id","size","mass","radius","pos","force","velocity","acceleration","beginPath","fillStyle","arc","fill","closePath","textAlign","textBaseline","fillText","f","add","Link","source","target","ForceDirected","options","initNodes","DEFAULTS","GRAVITY","REPULSION","Object","assign","forEach","node","gravity","i","length","j","node1","node2","dir","sub","distance","force1","inverseForce","link","neg_force","pos_force","force_copy","applyForcesTowardsCenter","applyRepulsiveForces","applyForcesExertedByConnections","updateNodesVelocity","NONE","Shape","type","isSelected","strokeStyle","color","Arc","radians","dx","dy","save","lineWidth","stroke","restore","Circle","Rectangle","rect","InputDeviceTracker","callback","self","addEventListener","onDown","bind","onMove","onUp","evt","getBoundingClientRect","offsetTop","top","offsetLeft","left","touches","clientX","clientY","preventDefault","coords","getCoordinatesFromEvent","Renderer","w","fillRect","moveTo","lineTo","MChart","container","startX","startY","lastMoveX","lastMoveY","document","getElementById","innerWidth","innerHeight","renderer","display_grid","selection","objects","isSelecting","isDragging","clicked_on_the_canvas","object","push","draw","clearRect","drawGrid","render","bbox","getBBox","evtType","mouseIsDown","isHit","constructor","name","moveObjectToLastPosition","selection_startX","selection_startY","rectContainsShape","x1","y1","x2","y2","inputDeviceTracker","manageInputEvents","object_list","object_to_move","index","splice","rectangle","shape","rectContainsCircle","rectContainsRect","rect1","rect2","result_X","result_Y","circle","left_include","right_include","bottom_include","top_include","version"],"mappings":"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"}